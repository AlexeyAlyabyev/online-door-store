{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <!-- <button type="submit" form="form-seo-url" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button> -->
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">{% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    <div class="panel panel-default">

			{% if attribute_id and attribute_values %}
				{% for attribute_value in attribute_values %}
					<form class="attribute_seo">
						<div class="panel-heading">
							<h3 class="panel-title">{{ attribute_value.text }}</h3>
							<button type="button" class="btn btn-primary btn_toggle"><i class="fa fa-plus"></i></button>
						</div>
						<div class="attribute_seo_value form-horizontal panel-body">
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-query">{{ entry_query }}</label>
								<div class="col-sm-8">
									<input type="text" name="query" value="{{ attribute_value.query }}" id="input-query" class="form-control disabled" />
									{% if error_query %}
										<div class="text-danger">{{ error_query }}</div>
									{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-keyword">{{ entry_keyword }}</label>
								<div class="col-sm-8">
									<input type="text" name="keyword" value="{{ attribute_value.keyword }}" placeholder="{{ entry_keyword }}" id="input-keyword" class="form-control" />
									{% if error_keyword %}
										<div class="text-danger">{{ error_keyword }}</div>
									{% endif %}
								</div>
								<div class="col-sm-2 action_buttons">
									<button type="button" data-toggle="tooltip" title="Сгенерировать" class="btn btn-primary translate"><i class="fa fa-refresh"></i></button>
									<button type="button" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary save"><i class="fa fa-save"></i></button>
								</div>
							</div>
							<div class="form-group hidden">
								<label class="col-sm-2 control-label" for="input-store">{{ entry_store }}</label>
								<div class="col-sm-10">
									<select name="store_id" id="input-store" class="form-control">
										{% for store in stores %}
											{% if store.store_id == store_id %}
												<option value="{{ store.store_id }}" selected="selected">{{ store.name }}</option>
											{% else %}
												<option value="{{ store.store_id }}">{{ store.name }}</option>
											{% endif %}
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="form-group hidden">
								<label class="col-sm-2 control-label" for="input-language">{{ entry_language }}</label>
								<div class="col-sm-10">
									<input type="hidden" name="language_id" id="input-language" value="{{ attribute_value.language_id }}">
								</div>
							</div>
							<input type="hidden" name="seo_url_id" value="{{ attribute_value.seo_url_id }}">
							<input type="hidden" name="user_token" value="{{ user_token }}">
						</div>
					</form>
				{% endfor %}
			{% endif %}

			{% if option_id and option_values %}
				{% for option_value in option_values %}
					<form class="attribute_seo">
						<div class="panel-heading">
							<h3 class="panel-title">{{ option_value.name }}</h3>
							<button type="button" class="btn btn-primary btn_toggle"><i class="fa fa-plus"></i></button>
						</div>
						<div class="attribute_seo_value form-horizontal panel-body">
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-query">{{ entry_query }}</label>
								<div class="col-sm-8">
									<input type="text" name="query" value="{{ option_value.query }}" id="input-query" class="form-control disabled" />
									{% if error_query %}
										<div class="text-danger">{{ error_query }}</div>
									{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-keyword">{{ entry_keyword }}</label>
								<div class="col-sm-8">
									<input type="text" name="keyword" value="{{ option_value.keyword }}" placeholder="{{ entry_keyword }}" id="input-keyword" class="form-control" />
									{% if error_keyword %}
										<div class="text-danger">{{ error_keyword }}</div>
									{% endif %}
								</div>
								<div class="col-sm-2 action_buttons">
									<button type="button" data-toggle="tooltip" title="Сгенерировать" class="btn btn-primary translate"><i class="fa fa-refresh"></i></button>
									<button type="button" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary save"><i class="fa fa-save"></i></button>
								</div>
							</div>
							<div class="form-group hidden">
								<label class="col-sm-2 control-label" for="input-store">{{ entry_store }}</label>
								<div class="col-sm-10">
									<select name="store_id" id="input-store" class="form-control">
										{% for store in stores %}
											{% if store.store_id == store_id %}
												<option value="{{ store.store_id }}" selected="selected">{{ store.name }}</option>
											{% else %}
												<option value="{{ store.store_id }}">{{ store.name }}</option>
											{% endif %}
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="form-group hidden">
								<label class="col-sm-2 control-label" for="input-language">{{ entry_language }}</label>
								<div class="col-sm-10">
									<input type="hidden" name="language_id" id="input-language" value="{{ option_value.language_id }}">
								</div>
							</div>
							<input type="hidden" name="seo_url_id" value="{{ option_value.seo_url_id }}">
							<input type="hidden" name="user_token" value="{{ user_token }}">
						</div>
					</form>
				{% endfor %}
			{% endif %}

			{% if manufacturers %}
				{% for manufacturer in manufacturers %}
					<form class="attribute_seo">
						<div class="panel-heading">
							<h3 class="panel-title">{{ manufacturer.name }}</h3>
							<button type="button" class="btn btn-primary btn_toggle"><i class="fa fa-plus"></i></button>
						</div>
						<div class="attribute_seo_value form-horizontal panel-body">
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-query">{{ entry_query }}</label>
								<div class="col-sm-8">
									<input type="text" name="query" value="{{ manufacturer.query }}" id="input-query" class="form-control disabled" />
									{% if error_query %}
										<div class="text-danger">{{ error_query }}</div>
									{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-keyword">{{ entry_keyword }}</label>
								<div class="col-sm-8">
									<input type="text" name="keyword" value="{{ manufacturer.keyword }}" placeholder="{{ entry_keyword }}" id="input-keyword" class="form-control" />
									{% if error_keyword %}
										<div class="text-danger">{{ error_keyword }}</div>
									{% endif %}
								</div>
								<div class="col-sm-2 action_buttons">
									<button type="button" data-toggle="tooltip" title="Сгенерировать" class="btn btn-primary translate"><i class="fa fa-refresh"></i></button>
									<button type="button" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary save"><i class="fa fa-save"></i></button>
								</div>
							</div>
							<div class="form-group hidden">
								<label class="col-sm-2 control-label" for="input-store">{{ entry_store }}</label>
								<div class="col-sm-10">
									<select name="store_id" id="input-store" class="form-control">
										{% for store in stores %}
											{% if store.store_id == store_id %}
												<option value="{{ store.store_id }}" selected="selected">{{ store.name }}</option>
											{% else %}
												<option value="{{ store.store_id }}">{{ store.name }}</option>
											{% endif %}
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="form-group hidden">
								<label class="col-sm-2 control-label" for="input-language">{{ entry_language }}</label>
								<div class="col-sm-10">
									<input type="hidden" name="language_id" id="input-language" value="{{ manufacturer.language_id }}">
								</div>
							</div>
							<input type="hidden" name="seo_url_id" value="{{ manufacturer.seo_url_id }}">
							<input type="hidden" name="user_token" value="{{ user_token }}">
						</div>
					</form>
				{% endfor %}
			{% endif %}

    </div>
  </div>
</div>
<script type="text/javascript"><!--

$("button.btn_toggle").click(function(){
	$(this).parent().next().toggleClass("active");
	$(this).find("i").toggleClass("fa-minus")
});

{% if attribute_id and attribute_values %}
	$("button.translate").click(function(){
		let keyword = ru2en.translit("{{ attribute_name }} " + $(this).parents(".attribute_seo").find("h3").text());
		$(this).parents(".attribute_seo").find("input[name='keyword']").val(keyword);
	});
	$(".attribute_seo .action_buttons button.save").click(function(){
		let seo_url_id = +$(this).parents(".attribute_seo").find("input[name='seo_url_id']").val();
		let keyword = $(this).parents(".attribute_seo").find("input[name='keyword']").val();
		let save_url;
		if (seo_url_id)
			if (keyword != "")
				save_url = "index.php?route=design/seo_filter/edit&user_token={{ user_token }}&seo_url_id=" + seo_url_id;
			else
				save_url = "index.php?route=design/seo_filter/deleteOne&user_token={{ user_token }}&seo_url_id=" + seo_url_id;
		else
			save_url = "index.php?route=design/seo_filter/add&user_token={{ user_token }}";
		$.ajax({
			url: save_url,
			method: "post",
			data: $(this).parents(".attribute_seo").serialize(),
			success: function(json) {
				let success_message = '<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ЧПУ для атрибута успешно задано!<button type="button" class="close" data-dismiss="alert">&times;</button> </div>'
				$(success_message).prependTo($("#content .container-fluid").eq(1));
				setTimeout(function(){
					$(".alert.alert-success").remove();
				}, 3000);
			}
		});
	});
{% endif %}

{% if option_id and option_values %}
	$("button.translate").click(function(){
		let keyword = ru2en.translit($(this).parents(".attribute_seo").find("h3").text());
		$(this).parents(".attribute_seo").find("input[name='keyword']").val(keyword);
	});
	$(".attribute_seo .action_buttons button.save").click(function(){
		let seo_url_id = +$(this).parents(".attribute_seo").find("input[name='seo_url_id']").val();
		let keyword = $(this).parents(".attribute_seo").find("input[name='keyword']").val();
		let save_url;
		if (seo_url_id)
			if (keyword != "")
				save_url = "index.php?route=design/seo_filter/edit&user_token={{ user_token }}&seo_url_id=" + seo_url_id;
			else
				save_url = "index.php?route=design/seo_filter/deleteOne&user_token={{ user_token }}&seo_url_id=" + seo_url_id;
		else
			save_url = "index.php?route=design/seo_filter/add&user_token={{ user_token }}";
		$.ajax({
			url: save_url,
			method: "post",
			data: $(this).parents(".attribute_seo").serialize(),
			success: function(json) {
				let success_message = '<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ЧПУ для атрибута успешно задано!<button type="button" class="close" data-dismiss="alert">&times;</button> </div>'
				$(success_message).prependTo($("#content .container-fluid").eq(1));
				setTimeout(function(){
					$(".alert.alert-success").remove();
				}, 3000);
			}
		});
	});
{% endif %}

{% if manufacturers %}
	$("button.translate").click(function(){
		let keyword = ru2en.translit("manufacturer-" + $(this).parents(".attribute_seo").find("h3").text());
		$(this).parents(".attribute_seo").find("input[name='keyword']").val(keyword);
	});
	$(".attribute_seo .action_buttons button.save").click(function(){
		let seo_url_id = +$(this).parents(".attribute_seo").find("input[name='seo_url_id']").val();
		let keyword = $(this).parents(".attribute_seo").find("input[name='keyword']").val();
		let save_url;
		if (seo_url_id)
			if (keyword != "")
				save_url = "index.php?route=design/seo_filter/edit&user_token={{ user_token }}&seo_url_id=" + seo_url_id;
			else
				save_url = "index.php?route=design/seo_filter/deleteOne&user_token={{ user_token }}&seo_url_id=" + seo_url_id;
		else
			save_url = "index.php?route=design/seo_filter/add&user_token={{ user_token }}";
		$.ajax({
			url: save_url,
			method: "post",
			data: $(this).parents(".attribute_seo").serialize(),
			success: function(json) {
				let success_message = '<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ЧПУ для атрибута успешно задано!<button type="button" class="close" data-dismiss="alert">&times;</button> </div>'
				$(success_message).prependTo($("#content .container-fluid").eq(1));
				setTimeout(function(){
					$(".alert.alert-success").remove();
				}, 3000);
			}
		});
	});
{% endif %}

//--></script> 
{{ footer }} 