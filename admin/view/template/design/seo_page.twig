{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <!-- <button type="submit" form="form-seo-url" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button> -->
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">{% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    <div class="panel panel-default">

			{% if attribute_id and attribute_values %}
				{% for attribute_value in attribute_values %}
					<form class="attribute_seo">
						<div class="panel-heading">
							<h3 class="panel-title">{{ attribute_value.text }}</h3>
							<button type="button" class="btn btn-primary btn_toggle"><i class="fa fa-plus"></i></button>
						</div>
						<div class="attribute_seo_value form-horizontal panel-body">
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-query">{{ entry_query }}</label>
								<div class="col-sm-8">
									<input type="text" name="query" value="{{ attribute_value.query }}" id="input-query" class="form-control disabled" />
									{% if error_query %}
										<div class="text-danger">{{ error_query }}</div>
									{% endif %}
								</div>
								<div class="col-sm-2 action_buttons">
									<button type="button" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary save"><i class="fa fa-save"></i></button>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-keyword">{{ entry_keyword }}</label>
								<div class="col-sm-8">
									<input type="text" name="keyword" value="{{ attribute_value.keyword }}" placeholder="{{ entry_keyword }}" id="input-keyword" class="form-control disabled" />
									{% if error_keyword %}
										<div class="text-danger">{{ error_keyword }}</div>
									{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-full_seo_url">Уникальный URL</label>
								<div class="col-sm-8">
									<input type="text" name="full_seo_url" value="{{ seo_url }}/{{ attribute_value.keyword }}/" id="input-full_seo_url" class="form-control disabled" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-meta_title">Meta-title</label>
								<div class="col-sm-8">
									<input type="text" name="meta_title" id="input-meta_title" value="{{ attribute_value.meta_title }}" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-meta_description">Meta-description</label>
								<div class="col-sm-8">
									<textarea type="text" name="meta_description" id="input-meta_description" rows="5" class="form-control">{{ attribute_value.meta_description }}</textarea>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-h1">H1</label>
								<div class="col-sm-8">
									<input type="text" name="h1" id="input-h1" value="{{ attribute_value.h1 }}" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-description">Описание</label>
								<div class="col-sm-8">
									<textarea type="text" name="description" data-toggle="summernote" data-lang="ru-RU" id="input-description" rows="5" class="form-control">{{ attribute_value.description }}</textarea>
								</div>
							</div>
							<input type="hidden" name="seo_url_id" value="{{ attribute_value.seo_url_id }}">
							<input type="hidden" name="seo_page_id" value="{{ attribute_value.seo_page_id }}">
							<input type="hidden" name="user_token" value="{{ user_token }}">
						</div>
					</form>
				{% endfor %}
			{% endif %}

			{% if option_id and option_values %}
				{% for option_value in option_values %}
					<form class="attribute_seo">
						<div class="panel-heading">
							<h3 class="panel-title">{{ option_value.name }}</h3>
							<button type="button" class="btn btn-primary btn_toggle"><i class="fa fa-plus"></i></button>
						</div>
						<div class="attribute_seo_value form-horizontal panel-body">
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-query">{{ entry_query }}</label>
								<div class="col-sm-8">
									<input type="text" name="query" value="{{ option_value.query }}" id="input-query" class="form-control disabled" />
									{% if error_query %}
										<div class="text-danger">{{ error_query }}</div>
									{% endif %}
								</div>
								<div class="col-sm-2 action_buttons">
									<button type="button" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary save"><i class="fa fa-save"></i></button>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-keyword">{{ entry_keyword }}</label>
								<div class="col-sm-8">
									<input type="text" name="keyword" value="{{ option_value.keyword }}" placeholder="{{ entry_keyword }}" id="input-keyword" class="form-control disabled" />
									{% if error_keyword %}
										<div class="text-danger">{{ error_keyword }}</div>
									{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-full_seo_url">Уникальный URL</label>
								<div class="col-sm-8">
									<input type="text" name="full_seo_url" value="{{ seo_url }}/{{ option_value.keyword }}/" id="input-full_seo_url" class="form-control disabled" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-meta_title">Meta-title</label>
								<div class="col-sm-8">
									<input type="text" name="meta_title" id="input-meta_title" value="{{ option_value.meta_title }}" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-meta_description">Meta-description</label>
								<div class="col-sm-8">
									<textarea type="text" name="meta_description" id="input-meta_description" rows="5" class="form-control">{{ option_value.meta_description }}</textarea>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-h1">H1</label>
								<div class="col-sm-8">
									<input type="text" name="h1" id="input-h1" value="{{ option_value.h1 }}" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-description">Описание</label>
								<div class="col-sm-8">
									<textarea type="text" name="description" data-toggle="summernote" data-lang="ru-RU" id="input-description" rows="5" class="form-control">{{ option_value.description }}</textarea>
								</div>
							</div>
							<input type="hidden" name="seo_url_id" value="{{ option_value.seo_url_id }}">
							<input type="hidden" name="seo_page_id" value="{{ option_value.seo_page_id }}">
							<input type="hidden" name="user_token" value="{{ user_token }}">
						</div>
					</form>
				{% endfor %}
			{% endif %}

			{% if manufacturers %}
				{% for manufacturer in manufacturers %}
					<form class="attribute_seo">
						<div class="panel-heading">
							<h3 class="panel-title">{{ manufacturer.name }}</h3>
							<button type="button" class="btn btn-primary btn_toggle"><i class="fa fa-plus"></i></button>
						</div>
						<div class="attribute_seo_value form-horizontal panel-body">
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-query">{{ entry_query }}</label>
								<div class="col-sm-8">
									<input type="text" name="query" value="{{ manufacturer.query }}" id="input-query" class="form-control disabled" />
									{% if error_query %}
										<div class="text-danger">{{ error_query }}</div>
									{% endif %}
								</div>
								<div class="col-sm-2 action_buttons">
									<button type="button" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary save"><i class="fa fa-save"></i></button>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-keyword">{{ entry_keyword }}</label>
								<div class="col-sm-8">
									<input type="text" name="keyword" value="{{ manufacturer.keyword }}" placeholder="{{ entry_keyword }}" id="input-keyword" class="form-control disabled" />
									{% if error_keyword %}
										<div class="text-danger">{{ error_keyword }}</div>
									{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-full_seo_url">Уникальный URL</label>
								<div class="col-sm-8">
									<input type="text" name="full_seo_url" value="{{ seo_url }}/{{ manufacturer.keyword }}/" id="input-full_seo_url" class="form-control disabled" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-meta_title">Meta-title</label>
								<div class="col-sm-8">
									<input type="text" name="meta_title" id="input-meta_title" value="{{ manufacturer.meta_title }}" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-meta_description">Meta-description</label>
								<div class="col-sm-8">
									<textarea type="text" name="meta_description" id="input-meta_description" rows="5" class="form-control">{{ manufacturer.meta_description }}</textarea>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-h1">H1</label>
								<div class="col-sm-8">
									<input type="text" name="h1" id="input-h1" value="{{ manufacturer.h1 }}" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label" for="input-description">Описание</label>
								<div class="col-sm-8">
									<textarea type="text" name="description" data-toggle="summernote" data-lang="ru-RU" id="input-description" rows="5" class="form-control">{{ manufacturer.description }}</textarea>
								</div>
							</div>
							<input type="hidden" name="seo_url_id" value="{{ manufacturer.seo_url_id }}">
							<input type="hidden" name="seo_page_id" value="{{ manufacturer.seo_page_id }}">
							<input type="hidden" name="user_token" value="{{ user_token }}">
						</div>
					</form>
				{% endfor %}
			{% endif %}

    </div>
  </div>
</div>

<link href="view/javascript/codemirror/lib/codemirror.css" rel="stylesheet" />
<link href="view/javascript/codemirror/theme/monokai.css" rel="stylesheet" />
<script type="text/javascript" src="view/javascript/codemirror/lib/codemirror.js"></script> 
<script type="text/javascript" src="view/javascript/codemirror/lib/xml.js"></script> 
<script type="text/javascript" src="view/javascript/codemirror/lib/formatting.js"></script> 

<script type="text/javascript" src="view/javascript/summernote/summernote.js"></script>
<link href="view/javascript/summernote/summernote.css" rel="stylesheet" />
<script type="text/javascript" src="view/javascript/summernote/summernote-image-attributes.js"></script>
<script type="text/javascript" src="view/javascript/summernote/opencart.js"></script>

<script type="text/javascript"><!--

$("button.btn_toggle").click(function(){
	$(this).parent().next().toggleClass("active");
	$(this).find("i").toggleClass("fa-minus")
});

$(".attribute_seo .action_buttons button.save").click(function(){
	let seo_page_id = +$(this).parents(".attribute_seo").find("input[name='seo_page_id']").val();
	let keyword = $(this).parents(".attribute_seo").find("input[name='keyword']").val();
	let save_url;
	if (seo_page_id)
		save_url = "index.php?route=design/seo_page/edit&user_token={{ user_token }}&seo_page_id=" + seo_page_id;
	else
		save_url = "index.php?route=design/seo_page/add&user_token={{ user_token }}";
	$.ajax({
		url: save_url,
		method: "post",
		data: $(this).parents(".attribute_seo").serialize(),
		success: function(json) {
			let success_message = '<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ЧПУ для атрибута успешно задано!<button type="button" class="close" data-dismiss="alert">&times;</button> </div>'
			$(success_message).prependTo($("#content .container-fluid").eq(1));
			setTimeout(function(){
				$(".alert.alert-success").remove();
			}, 3000);
		}
	});
});

//--></script> 
{{ footer }} 